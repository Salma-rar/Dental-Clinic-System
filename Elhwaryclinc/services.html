<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الخدمات والأسعار - عيادة الأسنان</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <h1><i class="fas fa-teeth"></i> الخدمات والأسعار</h1>
    </header>
    
    <nav>
        <ul>
            <li><a href="index.html"><i class="fas fa-home"></i> الرئيسية</a></li>
            <li><a href="patients.html"><i class="fas fa-user-injured"></i> المرضى</a></li>
            <li><a href="appointments.html"><i class="fas fa-calendar-alt"></i> المواعيد</a></li>
            <li><a href="payments.html"><i class="fas fa-money-bill-wave"></i> الدفع</a></li>
            <li><a class="active" href="services.html"><i class="fas fa-teeth"></i> الخدمات</a></li>
        </ul>
    </nav>
    
    <main>
        <section class="form-section">
            <h2><i class="fas fa-plus-circle"></i> إضافة خدمة جديدة</h2>
            <form id="serviceForm">
                <div class="form-group">
                    <input type="text" id="serviceName" required placeholder=" ">
                    <label for="serviceName">اسم الخدمة</label>
                </div>
                
                <div class="form-group">
                    <input type="number" id="servicePrice" required placeholder=" ">
                    <label for="servicePrice">السعر (جنية)</label>
                </div>
                
                <button type="submit"><i class="fas fa-save"></i> حفظ الخدمة</button>
                <div id="serviceMessage" class="confirmation-message"></div>
            </form>
        </section>
        
        <section class="table-section">
            <h2><i class="fas fa-list-ul"></i> قائمة الخدمات <small>(${clinicData.services.length} خدمة)</small></h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>اسم الخدمة</th>
                            <th>السعر</th>
                            <th>الإجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="serviceTable"></tbody>
                </table>
            </div>
        </section>
    </main>

   <script src="app.js"></script>
<script>
    const serviceForm = document.getElementById('serviceForm');
    const serviceTable = document.getElementById('serviceTable');
    const serviceMessage = document.getElementById('serviceMessage');
    let editIndex = null; // لتحديد الخدمة التي نعدلها

    function displayServices() {
        serviceTable.innerHTML = '';

        if (clinicData.services.length === 0) {
            const row = document.createElement('tr');
            row.innerHTML = `<td colspan="4" class="no-data">لا توجد خدمات مسجلة</td>`;
            serviceTable.appendChild(row);
            return;
        }

        clinicData.services.forEach((service, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td>
                <td>${service.name}</td>
                <td>${service.price} ج</td>
                <td class="actions">
                    <button class="edit" data-id="${index}">
                        <i class="fas fa-edit"></i> تعديل
                    </button>
                    <button class="delete" data-id="${index}">
                        <i class="fas fa-trash"></i> حذف
                    </button>
                </td>
            `;
            serviceTable.appendChild(row);
        });

        // زرار الحذف
        document.querySelectorAll('.delete').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const id = e.target.closest('button').getAttribute('data-id');
                if (confirm('هل أنت متأكد من حذف هذه الخدمة؟')) {
                    clinicData.services.splice(id, 1);
                    saveData();
                    displayServices();
                    showMessage('تم حذف الخدمة بنجاح', 'success');
                }
            });
        });

        // زرار التعديل
        document.querySelectorAll('.edit').forEach(btn => {
            btn.addEventListener('click', (e) => {
                editIndex = e.target.closest('button').getAttribute('data-id');
                const service = clinicData.services[editIndex];
                document.getElementById('serviceName').value = service.name;
                document.getElementById('servicePrice').value = service.price;
                document.querySelector('#serviceForm button[type="submit"]').innerHTML = '<i class="fas fa-save"></i> تحديث الخدمة';
            });
        });
    }

    // إضافة أو تعديل خدمة
    serviceForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const name = document.getElementById('serviceName').value;
        const price = parseFloat(document.getElementById('servicePrice').value);

        if (editIndex === null) {
            // إضافة جديدة
            clinicData.services.push({ id: Date.now(), name, price });
            showMessage('تم إضافة الخدمة بنجاح', 'success');
        } else {
            // تعديل
            clinicData.services[editIndex].name = name;
            clinicData.services[editIndex].price = price;
            showMessage('تم تحديث الخدمة بنجاح', 'success');
            editIndex = null;
            document.querySelector('#serviceForm button[type="submit"]').innerHTML = '<i class="fas fa-save"></i> حفظ الخدمة';
        }

        saveData();
        serviceForm.reset();
        displayServices();
    });

    function showMessage(text, type) {
        serviceMessage.textContent = text;
        serviceMessage.className = `confirmation-message ${type}`;
        serviceMessage.style.display = 'block';
        setTimeout(() => serviceMessage.style.display = 'none', 3000);
    }

    // تحميل البيانات
    displayServices();
</script>
